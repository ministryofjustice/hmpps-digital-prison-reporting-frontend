{% from "../../../../code-block/view.njk" import dprCodeBlock %}

{% from "./report-data-table-wrapper/view.njk" import dprDataTableWrapper %}
{% from "./report-totals/view.njk" import dprReportTotals %}
{% from "./report-summary-table/view.njk" import dprReportSummary %}
{% from "./report-section/view.njk" import dprReportSection %}

{% macro dprReport(options, count, template) %}
  {% set reportSummaries = options.reportSummaries %}
  {% set dataTable = options.dataTable %}
  {% set pagination = options.pagination %}
  {% set classification = options.classification %}
  {% set template = options.template %}

  {% for summary in dataTable[0].summaries %}
    {{ dprReportSummary(summary, 'page-header') }}
  {% endfor %}

  {{ dprReportTotals(options.totals) }}
  
  <div class='dpr-table-container dpr-table-container--{{ template }}'>

    {% 
      if template === 'parent-child' 
      or template === 'parent-child-section' 
      or template === 'list-section' 
      or template === 'summary-section'  
      or template === 'list'
    %}
    
      {{ dprReportSection(dataTable[0], template, classification) }}

    {% elif template === 'summary' %}
      
      {% set reportSummaries = renderData.reportSummaries %}
      {{ dprReportSummary(reportSummaries, 'page-header') }}
      {{ dprReportSummary(reportSummaries, 'page-footer') }}

    {% else %}

      {{ dprDataTableWrapper(dataTable, classification) }}
    
    {% endif %}
  </div>
  
  <div class='govuk-!-margin-bottom-6 govuk-!-margin-top-6'>
    {{ dprReportTotals(options.totals) }}
  </div>

  {% for summary in dataTable[0].summaries %}
    {{ dprReportSummary(summary, 'page-footer') }}
  {% endfor %}

{% endmacro %}
