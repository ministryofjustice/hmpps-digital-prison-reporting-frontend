
{%- from "moj/components/ticket-panel/macro.njk" import mojTicketPanel -%}

{% macro dprDownloadMessage(reportData) %}
  {% set reportId = reportData.reportId %}
  {% set id = reportData.id %}
  {% set loadType = reportData.loadType %}

  {% if loadType === 'async' %}
    {% set tableId = reportData.tableId %}
    {% set feedbackFormHref = "/download/"+ reportId + "/" + id + "/" + tableId + "/feedback"  %}
  {% else %}
    {% set feedbackFormHref = "/download/"+ reportId + "/" + id + "/feedback"  %}
  {% endif %}

  {% set html %}
    <h2 class="govuk-heading-m govuk-!-margin-bottom-2">You do not have permission to download this report</h2>
    <p class="govuk-body">To gain access to download this report, please complete the download request form</p>
    <a href="{{ feedbackFormHref }}" class="govuk-button govuk-!-margin-bottom-1" data-module="govuk-button">
      Go to form
    </a>
  {% endset %}

  <div id="dpr-download-message" class="dpr-download-message--hidden govuk-!-margin-bottom-6" data-dpr-module='download-message'>
    {{ mojTicketPanel({
      attributes: {
        'aria-label': 'Sub navigation 1'
      },
      items: [{
        html: html,
        attributes: {
          'aria-label': 'Section 1'
        },
        classes: 'moj-ticket-panel__content--blue'
      }]
    }) }}
  </div>
{% endmacro %}
