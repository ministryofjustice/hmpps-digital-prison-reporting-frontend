{% from "../accordion/view.njk" import dprAccordion %}
{% from "../sync-filters/view.njk" import dprSyncFilters %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% macro dprFiltersSection(filterOptions) %}
  {% set filters = filterOptions.filters %}
  {% set accordionItems = [] %}

  {% if filters.length > 0 %}
    
    {% set selectedFilters = filterOptions.selectedFilters %}
    {% set urlWithNoFilters = filterOptions.urlWithNoFilters %}

    {% set filterHtml %}
      <div class="data-table-filters">
        {{ dprSyncFilters( filters, urlWithNoFilters ) }}
      </div>
    {% endset %}

    {% set filtersHeaderHtml %}
      {%- for selectedFilter in selectedFilters %}
        <div class="selected-accordion-button">
          {{ govukButton(selectedFilter) }}
        </div>
      {%- endfor %}
    {% endset %}
    
    {% set filtersAccordionItem = {
      summaryText: 'Filters',
      bodyHtml: filterHtml,
      headerHtml: filtersHeaderHtml
    } %}
    {% set accordionItems = (accordionItems.push(filtersAccordionItem), accordionItems) %}
    
  {% endif %}

  {{ dprAccordion(accordionItems) }}
{% endmacro %}
